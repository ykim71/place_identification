# ykim8771@gmail.com Google API setting
library(ggmap)
library(tidyverse)
library(mapview)
library(openxlsx)
data <- read.csv("ner_place_freq_n5.csv")
# test
data_20 <- data[1:20,]
data_20 <- data_20 %>% mutate_geocode(location = unique_values, output = "latlona")
data_20 <- data_20 %>% mutate(unique_values_usa = paste0(unique_values, ", USA"))
data_20 <- data_20 %>% mutate_geocode(location = unique_values, output = "latlona")
geocode("the United States", output = "latlona")
# all data
data <- data %>% mutate_geocode(location = unique_values, output = "latlona")
data_done <- data %>% filter(is.na(address)==FALSE)
data_re <- data %>% filter(is.na(address)==TRUE)
data_re <- data_re %>% mutate_geocode(location = unique_values, output = "latlona")
data_re <- data_re %>% mutate(lon = `lon...7`, lat = `lat...8`, address = `address...9`)
data_re <- data_re %>% select(-contains("..."))
data_merge <- rbind(data_done, data_re)
data_merge <- data_merge %>% arrange(-desc(X))
data_merge_true <- data_merge %>% filter(is.na(address)==FALSE)
write.xlsx(data_merge, "data_merge.xlsx")
# view
data_merge_true %>%
mapview(cex = "counts", xcol = "lon", ycol = "lat", crs = 4269, grid = FALSE)
data_merge <- read.xlsx('data_merge.xlsx')
data_merge_true <- data_merge %>% filter(is.na(address)==FALSE)
# view
data_merge_true %>%
mapview(cex = "counts", xcol = "lon", ycol = "lat", crs = 4269, grid = FALSE)
library(tidyverse)
place_org <- readRDS("places_original.RDS")
place_pa <- readRDS("places_pa.RDS")
place_usa <- readRDS("places_usa.RDS")
View(place_pa)
View(place_org)
View(place_usa)
View(place_pa)
View(place_org)
place_org_true <- place_org %>% filter(is.na(unique_values)==FALSE)
View(place_org_true)
place_org_true <- place_org %>% filter(is.na(address)==FALSE)
View(place_org_true)
temp <- place_pa %>% filter(is.na(address)=FALSE)
temp <- place_pa %>% filter(is.na(address)==FALSE)
temp <- place_pa %>% filter(is.na(address_pa)==FALSE)
View(temp)
colnames(place_pa) <- paste(colnames(place_pa), "pa", sep = "_")
View(place_pa)
place_pa <- place_pa %>% mutate(unique_values = unique_values_pa_pa) %>% select(-unique_values_pa_pa)
View(place_pa)
place_pa <- place_pa %>% mutate(unique_values_pa = unique_values) %>% select(-unique_values)
View(place_pa)
place_org_true <- place_org_true %>% mutate(unique_values_pa = paste0(unique_values, ", PA, USA"))
View(place_org_true)
place_pa <- readRDS("places_pa.RDS")
colnames(place_pa) <- paste(colnames(place_pa), "pa", sep = "_")
names(place_pa)
place_pa <- place_pa %>% rename(unique_values_pa_pa, unique_values_pa)
?rename
place_pa <- place_pa %>% mutate(unique_values_pa = unique_values_pa_pa) %>% select(-unique_values_pa_pa)
View(place_pa)
place_org_true_merge <- list(place_org_true, place_pa) %>% reduce(left_join, by="unique_values_pa")
View(place_org_true_merge)
place_org_true_merge <- place_org_true_merge %>% mutate(agree = ifelse(address==address_pa,1,0))
View(place_org_true_merge)
table(place_org_true_merge$agree)
library(openxlsx)
?
write_xlsx
?read_excel
library(readxl)
?readxl
write_csv(place_org_true_merge, "place_org_true_merge.xlsx")
write_csv(place_org_true_merge, "place_org_true_merge.csv")
rm(temp)
library(openxlsx)
library(tidyverse)
place_org <- readRDS("places_original.RDS")
place_pa <- readRDS("places_pa.RDS")
place_usa <- readRDS("places_usa.RDS")
place_org_true <- place_org %>% filter(is.na(address)==FALSE)
place_org_true <- place_org_true %>% mutate(unique_values_pa = paste0(unique_values, ", PA, USA"))
colnames(place_pa) <- paste(colnames(place_pa), "pa", sep = "_")
place_pa <- place_pa %>% mutate(unique_values_pa = unique_values_pa_pa) %>% select(-unique_values_pa_pa)
place_org_true_merge <- list(place_org_true, place_pa) %>% reduce(left_join, by="unique_values_pa")
place_org_true_merge <- place_org_true_merge %>% mutate(agree = ifelse(address==address_pa,1,0))
table(place_org_true_merge$agree) # not agree = 2143
write.xlsx(place_org_true_merge, "place_org_true_merge.xlsx")
View(place_pa)
View(place_org)
View(place_org_true)
place_org_true_merge <- list(place_org_true, place_pa) %>% reduce(left_join, by="unique_values_pa")
View(place_org_true_merge)
View(place_pa)
place_org_true_merge <- place_org_true_merge %>% mutate(agree = ifelse(address==address_pa,1,0))
View(place_org_true_merge)
